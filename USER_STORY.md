ระบบคลังสินค้าแบบเบา ๆ สำหรับติดตามสต็อกสินค้า บันทึกความเคลื่อนไหวสต็อก (รับเข้า/ตัดออก) และแจ้งเตือนสินค้าใกล้หมด พร้อมความสามารถให้ผู้ใช้ขอคำแนะนำจำนวนสั่งซื้อ (Mock AI) เพื่อช่วยตัดสินใจเติมสต็อกอย่างรวดเร็ว

จุดมุ่งหมายหลัก
- เก็บข้อมูลสินค้า (SKU, ชื่อ, หน่วย, เกณฑ์สั่งซื้อซ้ำขั้นต่ำ, ยอดคงเหลือ)
- บันทึกความเคลื่อนไหวสต็อก (IN/OUT) แบบธุรกรรม ให้ยอดคงเหลือถูกต้องเสมอ
- แสดงรายการสินค้าใกล้หมด (Low‑Stock) และประวัติการเคลื่อนไหวล่าสุดบนแดชบอร์ด
- ให้ผู้จัดการขอคำแนะนำจำนวนสั่งซื้อ (Mock AI) โดยอิงข้อมูลพื้นฐาน เช่น ยอดเบิกออกช่วงสั้น ๆ และเกณฑ์ขั้นต่ำ

ขอบเขตการใช้งาน
- เจ้าหน้าที่คลังสินค้า: จัดการสินค้า, บันทึก IN/OUT, ตรวจสอบ Low‑Stock
- ผู้จัดการ: ดูภาพรวม, ตรวจสอบสินค้าใกล้หมด/ความเคลื่อนไหวล่าสุด, ขอคำแนะนำสั่งซื้อ
- ผู้ชม/พนักงานทั่วไป: ดูข้อมูลตามที่ระบบเปิดให้

คีย์แนวคิดและกติกา
- Low‑Stock: ถือว่าใกล้หมดเมื่อ `stock_on_hand < reorder_level`
- OUT ห้ามทำให้ยอดคงเหลือเป็นค่าติดลบ (ระบบต้องปฏิเสธพร้อมเหตุผลที่ชัดเจน)
- ทุก Movement (IN/OUT) ต้องบันทึกเป็นประวัติและคำนวณยอดคงเหลือแบบอะตอมมิก
- คำแนะนำสั่งซื้อ (Mock AI) แสดงจำนวนที่แนะนำและฐานอ้างอิง (เช่น weekly_out, reorder_level, stock_on_hand)

ยอมรับผลงาน (ภาพรวม)
- สร้าง/แก้ไขสินค้าได้ตามสิทธิ์ และป้องกัน SKU ซ้ำ
- บันทึก IN/OUT แล้วยอดคงเหลืออัปเดตถูกต้องและไม่ติดลบ
- แดชบอร์ดแสดง Low‑Stock และประวัติ IN/OUT ล่าสุด พร้อมสถานะโหลด/ว่าง/ผิดพลาด
- คำแนะนำสั่งซื้อแสดงจำนวนและเหตุผลอ้างอิงชัดเจน แม้ไม่มีข้อมูล OUT ล่าสุด


User Stories (TH)

1) จัดการสินค้า (Manage Products)
As an: เจ้าหน้าที่คลังสินค้า
I want to: สร้างและอัปเดตข้อมูลหลักของสินค้า
So that: ฉันจะได้ดูแลเกณฑ์สต็อกขั้นต่ำและข้อมูลสินค้าให้ถูกต้อง

Details:
- การเข้าถึงและสิทธิ์ (Access & Permission)
  - เจ้าหน้าที่คลังสินค้า: สร้างและอัปเดตสินค้าได้
  - ผู้ชม/พนักงาน: ดูรายการสินค้าได้เท่านั้น
  - ตำแหน่งเมนู: Inventory > Products
- รูปแบบการแสดงผล (Display Format)
  - ตารางคอลัมน์: SKU, ชื่อ, หน่วย, สต็อกคงเหลือ (Stock on Hand), ระดับสั่งซื้อซ้ำขั้นต่ำ (Reorder Level), สถานะ (Low/OK)
  - ช่องค้นหา SKU/ชื่อ และสวิตช์ “เฉพาะสต็อกใกล้หมด”
- เพิ่ม (Add)
  - สร้างสินค้าใหม่พร้อม SKU (ไม่ซ้ำ), ชื่อ, หน่วย, และระดับสั่งซื้อซ้ำขั้นต่ำ
- ดู (View)
  - รายการและตัวกรองสินค้า; แสดงสถานะเป็น Low เมื่อ `stock_on_hand < reorder_level`
- แก้ไข (Edit)
  - อัปเดตชื่อ, หน่วย, ระดับสั่งซื้อซ้ำขั้นต่ำ; ค่า Stock on Hand เป็นแบบอ่านอย่างเดียว (อัปเดตผ่าน Movement เท่านั้น)
- ลบ (Delete)
  - ไม่จำเป็นสำหรับงาน Hackathon (อาจทำ soft delete ได้ถ้ามีเวลา)

Acceptance Criteria:
- การสร้างสินค้าที่มี SKU ซ้ำต้องถูกปฏิเสธพร้อมข้อความผิดพลาดที่ชัดเจน
- โหมด “เฉพาะสต็อกใกล้หมด” แสดงเฉพาะสินค้าที่ `stock_on_hand < reorder_level`
- การค้นหาและตัวกรองทำงานร่วมกันได้
- มีสถานะว่าง/กำลังโหลด/ผิดพลาดให้เห็นชัดเจน

2) บันทึกความเคลื่อนไหวสต็อก (IN/OUT) (Record Stock Movement)
As an: เจ้าหน้าที่คลังสินค้า
I want to: บันทึกการรับเข้า (IN) และตัดสต็อกออก (OUT)
So that: ค่าสต็อกคงเหลือถูกต้องแบบเรียลไทม์

Details:
- การเข้าถึงและสิทธิ์ (Access & Permission)
  - เจ้าหน้าที่คลังสินค้า: สร้าง Movement แบบ IN/OUT ได้
  - ผู้ชม/พนักงาน: ดูรายการ Movement ล่าสุดได้
  - ตำแหน่งเมนู: Inventory > Movements
- รูปแบบการแสดงผล (Display Format)
  - ฟอร์ม: สินค้า, ประเภท (IN/OUT), จำนวน, อ้างอิง (Reference), วันที่เวลา (Moved At)
  - ตาราง Movement ล่าสุด 20 รายการ
- เพิ่ม (Add)
  - การสร้าง Movement ต้องอัปเดต `stock_on_hand` แบบธุรกรรม (transactional)
- ดู (View)
  - เห็นเวลา, สินค้า, ประเภท, จำนวน, อ้างอิงของ Movement ล่าสุด
- แก้ไข (Edit)
  - ไม่จำเป็น (สำหรับงานนี้ Movement เป็นข้อมูลประวัติ ไม่แก้ไขย้อนหลัง)
- ลบ (Delete)
  - ไม่จำเป็น

Acceptance Criteria:
- IN ทำให้ `stock_on_hand` เพิ่มตามจำนวน
- OUT ทำให้ `stock_on_hand` ลดลงได้แต่ต้องไม่ติดลบ; ถ้าจะติดลบให้ตอบปฏิเสธพร้อมข้อความผิดพลาดที่ชัดเจน
- หลังบันทึก Movement สำเร็จ รายการสินค้าและสถานะ Low‑Stock ต้องสะท้อนค่าล่าสุด
- ตาราง Movement ล่าสุดอัปเดตโดยไม่ต้องโหลดหน้าใหม่ทั้งหมด (รีเฟรชข้อมูลก็ได้)

3) แดชบอร์ดสต็อกใกล้หมด (Low‑Stock Dashboard)
As a: ผู้จัดการ
I want to: เห็นรายการสต็อกใกล้หมดและความเคลื่อนไหวล่าสุดในภาพรวม
So that: ฉันจะได้จัดลำดับการสั่งซื้อและติดตามกิจกรรมสต็อกได้

Details:
- การเข้าถึงและสิทธิ์ (Access & Permission)
  - ผู้จัดการและเจ้าหน้าที่คลังสินค้า: ดูแดชบอร์ดได้
  - ผู้ชม/พนักงาน: ดูแดชบอร์ดได้
  - ตำแหน่งเมนู: Inventory > Dashboard
- รูปแบบการแสดงผล (Display Format)
  - วิดเจ็ต Low‑Stock: แสดง SKU, ชื่อ, สต็อกคงเหลือ, ระดับสั่งซื้อซ้ำขั้นต่ำ
  - วิดเจ็ต Recent Movements: แสดงความเคลื่อนไหวล่าสุด
  - ปุ่มการกระทำแบบด่วน (ถ้ามี): Reorder Suggestion ต่อสินค้า (เปิดโมดัล)
- เพิ่ม (Add): N/A
- ดู (View)
  - ค้นหา/กรอง และรายการ Low‑Stock อัปเดตตามคำค้น
- แก้ไข (Edit): N/A
- ลบ (Delete): N/A

Acceptance Criteria:
- วิดเจ็ต Low‑Stock แสดงเฉพาะสินค้าที่ `stock_on_hand < reorder_level`
- วิดเจ็ต Recent Movements แสดงอย่างน้อย 10 รายการล่าสุด
- มีสถานะว่าง/กำลังโหลด/ผิดพลาดให้เห็นชัด
- ประสิทธิภาพใช้งานได้ลื่นไหลกับข้อมูล seed (ไม่มีการหน่วงจนรู้สึกได้)

4) ข้อเสนอปริมาณสั่งซื้อ (Mock AI) (Reorder Suggestion)
As a: ผู้จัดการ
I want to: ขอคำแนะนำจำนวนสั่งซื้อสำหรับสินค้า
So that: ฉันจะตัดสินใจจำนวนสั่งซื้อรอบถัดไปได้

Details:
- การเข้าถึงและสิทธิ์ (Access & Permission)
  - ผู้จัดการและเจ้าหน้าที่คลังสินค้า: ขอข้อเสนอได้
  - ตำแหน่งเมนู: Inventory > Dashboard (การกระทำจากแถวของสินค้า หรือเปิดโมดัล)
- รูปแบบการแสดงผล (Display Format)
  - โมดัลแสดง: Suggested Quantity และ Basis (เช่น `weekly_out`, `reorder_level`, `stock_on_hand`)
- เพิ่ม (Add): N/A
- ดู (View)
  - ทริกเกอร์คำขอข้อเสนอสำหรับสินค้าที่เลือกและแสดงผล
- แก้ไข (Edit): N/A
- ลบ (Delete): N/A

Acceptance Criteria:
- การขอคำแนะนำต้องคืนค่าจำนวนเต็มที่ไม่เป็นลบ พร้อมข้อมูล basis
- หากไม่มีข้อมูล OUT ล่าสุด ระบบยังคงให้คำแนะนำโดยพิจารณาจาก `reorder_level` และ `stock_on_hand`
- โมดัลมีสถานะกำลังโหลดและแสดงข้อผิดพลาดเมื่อเกิดปัญหา
- ปิดโมดัลแล้วต้องไม่เปลี่ยนแปลงข้อมูลสินค้าใด ๆ

Optional (Stretch) — รับสินค้าเข้าซื้อ (Purchase Intake)
As an: เจ้าหน้าที่คลังสินค้า
I want to: บันทึกรับสินค้าเข้าซื้ออย่างง่ายที่เพิ่มสต็อก
So that: ฉันเพิ่มสต็อกคงเหลือด้วยรายการรับเข้าที่มีหลักฐานอ้างอิงได้

Details:
- การเข้าถึงและสิทธิ์ (Access & Permission)
  - เจ้าหน้าที่คลังสินค้า: บันทึกการรับซื้อได้
  - ตำแหน่งเมนู: Inventory > Movements (ใช้ IN พร้อมอ้างอิง เช่น `PO-123`)
- รูปแบบการแสดงผล (Display Format)
  - ใช้ฟอร์ม Movement เดิม; ช่อง Reference เก็บเลขที่ PO
- เพิ่ม (Add)
  - สร้าง Movement แบบ IN พร้อม Reference
- ดู (View)
  - ตาราง Movement ล่าสุดแสดงรายการรับเข้าพร้อม Reference
- แก้ไข (Edit): N/A
- ลบ (Delete): N/A

Acceptance Criteria:
- การรับเข้า (IN) ผ่าน Purchase Intake อัปเดต `stock_on_hand` และปรากฏใน Recent Movements
- ค่า Reference ถูกบันทึกและมองเห็นได้